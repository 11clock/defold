#! /usr/bin/env python
import os, re

def configure(conf):
    pass

def build(bld):
    facebook = bld.new_task_gen(features = 'cxx cstaticlib embed',
                                includes = '.',
                                embed_source = '../resources/ios/close.png ../resources/ios/close@2x.png',
                                target = 'facebookext')
    facebook.find_sources_in_dirs('.')

    if not re.match('arm.*?darwin', bld.env.PLATFORM):
        # NOTE: This is a hack required when cross compiling on
        # darwin to linux platform
        # Objective-c files are collected as we don't have a proper platform
        # We patch CC, CXX, etc
        if './facebook.mm' in facebook.source:
            facebook.source.remove('./facebook.mm')

