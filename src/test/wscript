#! /usr/bin/env python
import os

def build(bld):

    bld.new_task_gen(features='javac seq',
                     classpath='../ext/jetty-all-7.0.2.v20100331.jar' + os.pathsep + '../ext/servlet-api-2.5.jar',
                     source_root='http_server')

    bld.env["JAVACFLAGS"] = '-g'
    bld.add_group()

    test_hashtable = bld.new_task_gen(features = 'cxx cprogram',
                                      source = 'test_hashtable.cpp',
                                      uselib = 'GTEST',
                                      includes = ['../../src'],
                                      target = 'test_hashtable')

    test_hashtable.install_path = None

    test_array = bld.new_task_gen(features = 'cxx cprogram',
                                      source = 'test_array.cpp',
                                      uselib = 'GTEST',
                                      uselib_local = "dlib",
                                      includes = ['../../src'],
                                      target = 'test_array')

    test_array.install_path = None

    test_iterator = bld.new_task_gen(features = 'cxx cprogram',
                                      source = 'test_iterator.cpp',
                                      uselib = 'GTEST',
                                      uselib_local = "dlib",
                                      includes = ['../../src'],
                                      target = 'test_iterator')

    test_iterator.install_path = None

    test_indexpool = bld.new_task_gen(features = 'cxx cprogram',
                                      source = 'test_indexpool.cpp',
                                      uselib = 'GTEST',
                                      uselib_local = "dlib",
                                      includes = ['../../src'],
                                      target = 'test_indexpool')

    test_indexpool.install_path = None

    test_dlib = bld.new_task_gen(features = 'cxx cprogram',
                                      source = 'test_dlib.cpp',
                                      uselib = 'GTEST',
                                      uselib_local = "dlib",
                                      includes = ['../../src'],
                                      target = 'test_dlib')

    test_dlib.install_path = None

    test_dlib = bld.new_task_gen(features = 'cxx cprogram',
                                      source = 'test_socket.cpp',
                                      uselib = 'GTEST PLATFORM_SOCKET THREAD',
                                      uselib_local = "dlib",
                                      includes = ['../../src'],
                                      target = 'test_socket')

    test_dlib.install_path = None

    test_dlib = bld.new_task_gen(features = 'cxx cprogram',
                                      source = 'test_time.cpp',
                                      uselib = 'GTEST',
                                      uselib_local = "dlib",
                                      includes = ['../../src'],
                                      target = 'test_time')

    test_dlib.install_path = None

    test_dlib = bld.new_task_gen(features = 'cxx cprogram',
                                 source = 'test_thread.cpp',
                                 uselib = 'GTEST THREAD',
                                 uselib_local = "dlib",
                                 includes = ['../../src'],
                                 target = 'test_thread')

    test_dlib.install_path = None

    test_dlib = bld.new_task_gen(features = 'cxx cprogram',
                                 source = 'test_profile.cpp',
                                 uselib = 'GTEST THREAD',
                                 uselib_local = "dlib",
                                 includes = ['../../src'],
                                 target = 'test_profile')

    test_dlib.install_path = None

    test_dlib = bld.new_task_gen(features = 'cxx cprogram',
                                 source = 'test_event.cpp',
                                 uselib = 'GTEST THREAD',
                                 uselib_local = "dlib",
                                 includes = ['../../src'],
                                 target = 'test_event')

    test_dlib.install_path = None

    test_dlib = bld.new_task_gen(features = 'cxx cprogram',
                                 source = 'test_configfile.cpp',
                                 uselib = 'GTEST THREAD',
                                 uselib_local = "dlib",
                                 includes = ['../../src'],
                                 target = 'test_configfile')

    test_dlib.install_path = None

    test_dstrings = bld.new_task_gen(features = 'cxx cprogram',
                                 source = 'test_dstrings.cpp',
                                 uselib = 'GTEST THREAD',
                                 uselib_local = "dlib",
                                 includes = ['../../src'],
                                 target = 'test_dstrings')

    test_dstrings.install_path = None

    test_http_client = bld.new_task_gen(features = 'cxx cprogram',
                                 source = 'test_httpclient.cpp',
                                 uselib = 'GTEST PLATFORM_SOCKET THREAD',
                                 uselib_local = "dlib",
                                 includes = ['../../src'],
                                 target = 'test_httpclient')

    test_http_client.install_path = None
