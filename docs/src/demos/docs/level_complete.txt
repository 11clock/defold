Level Complete
==============

In this sample, we demonstrate effects to show the score counting that could occur when a level has been completed.
A total score is counted up and three stars appears when different levels have been reached.
The sample also uses the reload functionality for fast turn-around when tweaking values.

link:#new_project:[Create a project] and select +Sample: Level Complete+ as 'Project Template' to try it out for yourself.

link:/youtube_embed/level_complete.ivf[Level Complete]

The scene is triggered by a message from the game.
The message contains the total score obtained and at which levels the three stars should appear.
When this happens, the heading text ("Level completed!") is fading in, while being scaled down to regular size (100%).
This is done in +on_message+ below.

After the animation of the heading text has completed, the total score is starting to count up.
Each time this happens, the current score is incremented by a small step.
Then we check if one of the star-levels has been crossed, in which case the animation of a star starts (see below).
As long as we haven't reached the target score, the total score is animated with a bouncing effect.
It will also grow towards a maximum in scale, the closer to the total score it gets.
In the same manner, its color shifts gradually from white to green.
This is done in +inc_score+.

Each time a star appears, it fades in and shrinks into regular size.
This is done in +animate_star+.

When the star has finished animating, the smaller stars are spawned in a circle around the bigger star.
This is done in +spawn_small_stars+.

Then they are animated to shoot out randomly from the star.
They are both randomized in speed and scale while expanding out.
Then they fade out and are eventually deleted.
This is done in +animate_small_star+ and +delete_small_star+.

When the score has reached the total score, the high-score imprint fades in and shrinks back into place.
This is started at the end of +inc_score+ and performed in +animate_imprint+.

The +setup+ function makes sure the nodes have the correct initial values.
By calling +setup+ from +on_reload+, we make sure that everything is setup correctly each time the script is reloaded from the Defold Editor.

[source,lua]
-------------------------------------------
-- file: level_complete.gui_script

include::../level_complete/level_complete.gui_script[tabsize=4]
-------------------------------------------
